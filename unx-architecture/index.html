---
layout: null
---
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNX Agent System Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: #f8f6f2;
            color: #3d3d3d;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, #e8e4f0 0%, #d4e4f7 100%);
            border-bottom: 2px solid #b8a9d4;
            padding: 40px 60px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            color: #2d2d3d;
            margin-bottom: 8px;
        }

        .header p {
            color: #6b6b80;
            font-size: 15px;
        }

        .header .badge {
            display: inline-block;
            background: #b8a9d4;
            color: #fff;
            padding: 3px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 12px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 60px;
        }

        .section {
            margin-bottom: 60px;
        }

        .section h2 {
            font-size: 20px;
            font-weight: 600;
            color: #7c6aa6;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h2::before {
            content: '';
            display: block;
            width: 4px;
            height: 20px;
            background: #b8a9d4;
            border-radius: 2px;
        }

        .section .subtitle {
            color: #8888a0;
            font-size: 14px;
            margin-bottom: 24px;
        }

        /* Mermaid ë˜í¼ */
        .mermaid-wrapper {
            background: #ffffff;
            border: 1px solid #e0dce8;
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: box-shadow 0.2s;
        }

        .mermaid-wrapper:hover {
            box-shadow: 0 4px 20px rgba(124, 106, 166, 0.15);
        }

        /* í´ë¦­ íŒíŠ¸ */
        .fullscreen-hint {
            position: absolute;
            bottom: 12px;
            right: 16px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: #aaa4b8;
            pointer-events: none;
            transition: opacity 0.2s;
        }

        .mermaid-wrapper:hover .fullscreen-hint {
            color: #7c6aa6;
        }

        .fullscreen-hint svg {
            width: 14px;
            height: 14px;
        }

        .zoom-controls {
            position: absolute;
            top: 12px;
            right: 12px;
            display: flex;
            gap: 6px;
            z-index: 10;
        }

        .zoom-controls button {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid #e0dce8;
            background: #fff;
            color: #7c6aa6;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .zoom-controls button:hover {
            background: #f0ecf5;
            border-color: #b8a9d4;
        }

        .zoom-controls .zoom-label {
            display: flex;
            align-items: center;
            padding: 0 10px;
            font-size: 12px;
            color: #8888a0;
            background: #f8f6ff;
            border-radius: 8px;
            border: 1px solid #e0dce8;
        }

        .mermaid-viewport {
            overflow: auto;
            cursor: grab;
            padding: 20px;
            min-height: 300px;
        }

        .mermaid-viewport:active {
            cursor: grabbing;
        }

        .mermaid-viewport .mermaid-inner {
            transform-origin: top left;
            transition: transform 0.15s ease;
            display: inline-block;
        }

        .mermaid {
            display: flex;
            justify-content: center;
        }

        /* ===== ì „ì²´í™”ë©´ ì˜¤ë²„ë ˆì´ ===== */
        .fullscreen-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(248, 246, 242, 0.97);
            z-index: 9999;
            flex-direction: column;
        }

        .fullscreen-overlay.active {
            display: flex;
        }

        .fullscreen-toolbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 24px;
            background: #fff;
            border-bottom: 1px solid #e0dce8;
            flex-shrink: 0;
        }

        .fullscreen-toolbar .title {
            font-size: 15px;
            font-weight: 600;
            color: #7c6aa6;
        }

        .fullscreen-toolbar .toolbar-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .fullscreen-toolbar button {
            height: 36px;
            border-radius: 8px;
            border: 1px solid #e0dce8;
            background: #fff;
            color: #7c6aa6;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.06);
        }

        .fullscreen-toolbar button:hover {
            background: #f0ecf5;
            border-color: #b8a9d4;
        }

        .fullscreen-toolbar button.zoom-btn {
            width: 36px;
            font-size: 18px;
            font-weight: 600;
        }

        .fullscreen-toolbar .fs-zoom-label {
            display: flex;
            align-items: center;
            padding: 0 10px;
            height: 36px;
            font-size: 12px;
            color: #8888a0;
            background: #f8f6ff;
            border-radius: 8px;
            border: 1px solid #e0dce8;
        }

        .fullscreen-toolbar .exit-btn {
            padding: 0 16px;
            gap: 6px;
            background: #7c6aa6;
            color: #fff;
            border-color: #7c6aa6;
        }

        .fullscreen-toolbar .exit-btn:hover {
            background: #6b5a94;
        }

        .fullscreen-viewport {
            flex: 1;
            overflow: auto;
            cursor: grab;
            padding: 40px;
        }

        .fullscreen-viewport:active {
            cursor: grabbing;
        }

        .fullscreen-viewport .fs-inner {
            transform-origin: top left;
            transition: transform 0.15s ease;
            display: inline-block;
        }

        /* ESC íŒíŠ¸ */
        .esc-hint {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(61, 61, 61, 0.8);
            color: #fff;
            padding: 6px 16px;
            border-radius: 6px;
            font-size: 12px;
            z-index: 10000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .fullscreen-overlay.active .esc-hint {
            animation: fadeHint 3s forwards;
        }

        @keyframes fadeHint {
            0% { opacity: 1; }
            70% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Agent ì¹´ë“œ ê·¸ë¦¬ë“œ */
        .agent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .agent-card {
            background: #ffffff;
            border: 1px solid #e0dce8;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.2s;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }

        .agent-card:hover {
            border-color: #b8a9d4;
            box-shadow: 0 4px 12px rgba(184,169,212,0.2);
            transform: translateY(-2px);
        }

        .agent-card .icon { font-size: 28px; margin-bottom: 10px; }
        .agent-card h3 { font-size: 16px; font-weight: 600; color: #2d2d3d; margin-bottom: 6px; }
        .agent-card p { font-size: 13px; color: #6b6b80; }
        .agent-card .modes { margin-top: 12px; display: flex; flex-wrap: wrap; gap: 6px; }
        .agent-card .mode-tag {
            font-size: 11px; padding: 2px 8px; border-radius: 3px;
            background: #f0ecf5; color: #7c6aa6; border: 1px solid #e0dce8;
        }

        /* ë°ì´í„° íë¦„ í…Œì´ë¸” */
        .flow-table {
            width: 100%; border-collapse: collapse; font-size: 14px;
            background: #fff; border-radius: 8px; overflow: hidden;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }
        .flow-table th {
            background: #f0ecf5; color: #7c6aa6; padding: 12px 16px;
            text-align: left; font-weight: 600; border-bottom: 2px solid #e0dce8;
        }
        .flow-table td { padding: 10px 16px; border-bottom: 1px solid #f0ecf5; color: #4d4d5d; }
        .flow-table tr:hover td { background: #faf8ff; }
        .flow-table code {
            background: #f0ecf5; color: #7c6aa6; padding: 2px 6px; border-radius: 3px; font-size: 12px;
        }

        .phase-label {
            display: inline-block; padding: 4px 12px; border-radius: 4px;
            font-size: 12px; font-weight: 600; margin-bottom: 16px;
        }
        .phase-pre { background: #dbe9f7; color: #4a7fb5; border: 1px solid #b8d4f0; }
        .phase-live { background: #f7dbe1; color: #c25670; border: 1px solid #f0b8c4; }
        .phase-post { background: #e8ddf7; color: #8b6aaf; border: 1px solid #d4c0e8; }
        .phase-always { background: #dbf0e0; color: #5a9e6a; border: 1px solid #b8e0c0; }
    </style>
</head>
<body>

<!-- ì „ì²´í™”ë©´ ì˜¤ë²„ë ˆì´ -->
<div class="fullscreen-overlay" id="fullscreenOverlay">
    <div class="fullscreen-toolbar">
        <div class="title" id="fsTitle"></div>
        <div class="toolbar-controls">
            <button class="zoom-btn" onclick="fsZoom(-0.15)">âˆ’</button>
            <div class="fs-zoom-label" id="fsZoomLabel">Fit</div>
            <button class="zoom-btn" onclick="fsZoom(0.15)">+</button>
            <button class="zoom-btn" onclick="fsZoom(0, true)">â†º</button>
            <button class="exit-btn" onclick="exitFullscreen()">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                ë‚˜ê°€ê¸°
            </button>
        </div>
    </div>
    <div class="fullscreen-viewport" id="fsViewport">
        <div class="fs-inner" id="fsInner"></div>
    </div>
    <div class="esc-hint">ESCë¥¼ ëˆŒëŸ¬ ë‚˜ê°€ê¸°</div>
</div>

<div class="header">
    <h1>UNX Agent System Architecture</h1>
    <p>AI-Powered Live Streaming Agent System â€” ìºë¦­í„° Ã— ë°©ì†¡ ì„¸ì…˜ ë‹¨ìœ„ í•™ìŠµ ë£¨í”„</p>
    <span class="badge">v2 â€” í‰ê°€ ë¶„ì‚° êµ¬ì¡°</span>
</div>

<div class="container">

    <!-- ì—ì´ì „íŠ¸ ì¹´ë“œ -->
    <div class="section">
        <h2>ì—ì´ì „íŠ¸ êµ¬ì„±</h2>
        <p class="subtitle">5ê°œ ë…ë¦½ ì—ì´ì „íŠ¸, ê°ê° ìì²´ ëª©í‘œì™€ í‰ê°€ ì‚¬ì´í´ ë³´ìœ </p>
        <div class="agent-grid">
            <div class="agent-card">
                <div class="icon">ğŸ™ï¸</div>
                <h3>Live Agent</h3>
                <p>ë°©ì†¡ ì‹¤í–‰ê³¼ ì‹¤ì‹œê°„ íŒë‹¨. ë°©ì†¡ì˜ ì „Â·ì¤‘Â·í›„ ì „ ì‚¬ì´í´ì„ ì£¼ë„í•˜ëŠ” í•µì‹¬ ì—”ì§„.</p>
                <div class="modes">
                    <span class="mode-tag">prepare</span>
                    <span class="mode-tag">on_event</span>
                    <span class="mode-tag">review</span>
                </div>
            </div>
            <div class="agent-card">
                <div class="icon">ğŸ”</div>
                <h3>Scout Agent</h3>
                <p>ì™¸ë¶€ íŠ¸ë Œë“œÂ·ì†Œì¬ íƒìƒ‰. ìë™ í¬ë¡¤ë§ + ìˆ˜ë™ íŠ¸ë¦¬ê±°ë¡œ ë°©ì†¡ ì†Œì¬ ì›ì¬ë£Œ ìˆ˜ê¸‰.</p>
                <div class="modes">
                    <span class="mode-tag">auto crawl</span>
                    <span class="mode-tag">manual trigger</span>
                    <span class="mode-tag">evaluate</span>
                </div>
            </div>
            <div class="agent-card">
                <div class="icon">ğŸ“–</div>
                <h3>Persona Agent</h3>
                <p>ìºë¦­í„° ì„¸ê³„ê´€Â·í˜ë¥´ì†Œë‚˜ ê´€ë¦¬. Scout ì†Œì¬ë¥¼ ìºë¦­í„°ì— ë§ê²Œ ê°€ê³µí•˜ê³  ì í•©ë„ í‰ê°€.</p>
                <div class="modes">
                    <span class="mode-tag">adapt content</span>
                    <span class="mode-tag">evaluate</span>
                </div>
            </div>
            <div class="agent-card">
                <div class="icon">ğŸ¤</div>
                <h3>Bond Agent</h3>
                <p>íŒ¬ ê´€ê³„Â·ì»¤ë®¤ë‹ˆí‹° ê´€ë¦¬. ì´íƒˆ ê°ì§€, DM ì¶”ì²œ, ì„¸ê·¸ë¨¼íŠ¸ ë¶„ë¥˜ ë“± ë…ì ì•¡ì…˜ ìˆ˜í–‰.</p>
                <div class="modes">
                    <span class="mode-tag">fan management</span>
                    <span class="mode-tag">evaluate</span>
                </div>
            </div>
            <div class="agent-card">
                <div class="icon">ğŸ¨</div>
                <h3>Craft Agent</h3>
                <p>ì—ì…‹ ìƒì„±Â·ì œì‘. ìŠ¤í† ë¦¬ë³´ë“œ, ì´ë¯¸ì§€, ì˜ìƒ í´ë¦½. í–¥í›„ ë°©ì†¡ ì¤‘ ì‹¤ì‹œê°„ ìƒì„± í™•ì¥.</p>
                <div class="modes">
                    <span class="mode-tag">pre-production</span>
                    <span class="mode-tag" style="opacity:0.5">realtime (í–¥í›„)</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì•„í‚¤í…ì²˜ ë„í‘œ -->
    <div class="section">
        <h2>ì „ì²´ ë°ì´í„° íë¦„</h2>
        <p class="subtitle">í´ë¦­í•˜ë©´ ì „ì²´í™”ë©´ìœ¼ë¡œ í™•ëŒ€ë©ë‹ˆë‹¤</p>
        <div class="mermaid-wrapper" onclick="openFullscreen('main', 'ì „ì²´ ë°ì´í„° íë¦„')" data-diagram="main">
            <div class="zoom-controls" onclick="event.stopPropagation()">
                <button onclick="zoomDiagram('main', -0.1)">âˆ’</button>
                <div class="zoom-label" id="main-zoom-label">100%</div>
                <button onclick="zoomDiagram('main', 0.1)">+</button>
                <button onclick="zoomDiagram('main', 0, true)">â†º</button>
            </div>
            <div class="mermaid-viewport" id="main-viewport" onwheel="wheelZoom(event, 'main')" onclick="event.stopPropagation()">
                <div class="mermaid-inner" id="main-inner">
                    <pre class="mermaid" id="mermaid-main">
graph TB
    subgraph ALWAYS_ON["ğŸ”„ ìƒì‹œ ë™ì‘"]
        SCOUT["ğŸ” Scout Agent<br/>íŠ¸ë Œë“œÂ·ì†Œì¬ íƒìƒ‰<br/><br/>â€¢ ìë™: ì£¼ê¸°ì  íŠ¸ë Œë“œ í¬ë¡¤ë§<br/>â€¢ ìˆ˜ë™: ë°©ì†¡ ì¶”ì²œ ì†Œì¬ ìƒì„±"]
        BOND["ğŸ¤ Bond Agent<br/>íŒ¬ ê´€ê³„Â·ì»¤ë®¤ë‹ˆí‹°<br/><br/>â€¢ ì´íƒˆ ìœ„í—˜ íŒ¬ DM ì¶”ì²œ<br/>â€¢ ì„¸ê·¸ë¨¼íŠ¸ ìë™ ì¬ë¶„ë¥˜<br/>â€¢ íŒ¬ ê´€ê³„ íˆìŠ¤í† ë¦¬ ê´€ë¦¬"]
    end

    subgraph PRE_BROADCAST["ğŸ“‹ ë°©ì†¡ ì „ Prepare"]
        PERSONA["ğŸ“– Persona Agent<br/>ìºë¦­í„° ì„¸ê³„ê´€Â·í˜ë¥´ì†Œë‚˜<br/><br/>â€¢ Scout ì†Œì¬ë¥¼ ìºë¦­í„°ì— ë§ê²Œ ê°€ê³µ<br/>â€¢ ìºë¦­í„° ì„¤ì •Â·ë§íˆ¬Â·ê¸ˆê¸°ì‚¬í•­ ê´€ë¦¬"]
        CRAFT["ğŸ¨ Craft Agent<br/>ì—ì…‹ ì‚¬ì „ ì œì‘<br/><br/>â€¢ ìŠ¤í† ë¦¬ë³´ë“œÂ·ì´ë¯¸ì§€Â·ì˜ìƒ í´ë¦½"]
        PREPARE["ğŸ™ï¸ Live Agent âŸ¨prepareâŸ©<br/><br/>â€¢ BroadcastStrategy ìˆ˜ë¦½<br/>â€¢ ì†Œì¬íÂ·íŒ¬ì›Œì¹˜ë¦¬ìŠ¤íŠ¸Â·KPI ì„¤ì •"]
    end

    subgraph LIVE["âš¡ ë°©ì†¡ ì¤‘ On-Air"]
        LIVE_BRAIN["ğŸ™ï¸ Live Agent âŸ¨on_eventâŸ©<br/>ì‹¤ì‹œê°„ íŒë‹¨ ì—”ì§„<br/><br/>â€¢ ë§¤ ì´ë²¤íŠ¸ë§ˆë‹¤ íŒë‹¨<br/>â€¢ toolsë¡œ ë°ì´í„° ì¡°íšŒ<br/>â€¢ BroadcastStrategy ê¸°ë°˜ ì˜ì‚¬ê²°ì •"]
    end

    subgraph POST_BROADCAST["ğŸ“Š ë°©ì†¡ í›„ Review &amp; Evaluate"]
        REVIEW["ğŸ™ï¸ Live Agent âŸ¨reviewâŸ©<br/><br/>â€¢ íŒ©íŠ¸ ê¸°ë°˜ ì„¸ì…˜ ì •ë¦¬<br/>â€¢ ìê¸° ì „ëµ í‰ê°€<br/>â€¢ ê° ì—ì´ì „íŠ¸ì— ì‹ í˜¸ ë°°í¬"]
        
        PERSONA_EVAL["ğŸ“– Persona âŸ¨evaluateâŸ©<br/><br/>â€¢ ì†Œì¬ë³„ ìºë¦­í„° ì í•©ë„ í‰ê°€<br/>â€¢ content_pool ìŠ¤ì½”ì–´ ì—…ë°ì´íŠ¸<br/>â€¢ ìºë¦­í„° ê°€ì´ë“œë¼ì¸ ë¯¸ì„¸ ì¡°ì •"]
        
        BOND_EVAL["ğŸ¤ Bond âŸ¨evaluateâŸ©<br/><br/>â€¢ íŒ¬ ì„¸ê·¸ë¨¼íŠ¸ë³„ ë°˜ì‘ í•´ì„<br/>â€¢ fan_memory ì—…ë°ì´íŠ¸<br/>â€¢ DM ì¶”ì²œ íì‰"]
        
        SCOUT_EVAL["ğŸ” Scout âŸ¨evaluateâŸ©<br/><br/>â€¢ íŠ¸ë Œë“œ ì ì¤‘ë¥  í‰ê°€<br/>â€¢ íƒìƒ‰ ì „ëµ ë³´ì •<br/>â€¢ íƒìƒ‰ ìš°ì„ ìˆœìœ„ ì¬ì¡°ì •"]
    end

    CONTENT_POOL[("ğŸ“¦ Content Pool<br/>ìºë¦­í„° ë§ì¶¤ ì†Œì¬")]
    FAN_MEMORY[("ğŸ‘¥ Fan Memory<br/>íŒ¬ í”„ë¡œí•„Â·ê´€ê³„Â·íˆìŠ¤í† ë¦¬")]
    ASSET_STORE[("ğŸ—‚ï¸ Asset Store<br/>ì˜ìƒÂ·ì´ë¯¸ì§€Â·í”„ë¦¬ì…‹")]

    SCOUT -->|"raw_trends<br/>íŠ¸ë Œë“œ ì›ì¬ë£Œ"| PERSONA
    PERSONA -->|"adapted_content<br/>ìºë¦­í„° ë§ì¶¤ ì†Œì¬"| CONTENT_POOL
    BOND -->|"íŒ¬ ê´€ê³„ ê´€ë¦¬<br/>DM ì¶”ì²œ, ì„¸ê·¸ë¨¼íŠ¸ ê´€ë¦¬"| FAN_MEMORY

    CONTENT_POOL -->|"ìš°ì„ ìˆœìœ„ ì†Œì¬ ëª©ë¡"| PREPARE
    FAN_MEMORY -->|"VIP íŒ¬ ë¦¬ìŠ¤íŠ¸<br/>ì£¼ëª© íŒ¬ ì•Œë¦¼"| PREPARE
    PERSONA -->|"ìºë¦­í„° ì„¤ì • ìŠ¤ëƒ…ìƒ·<br/>ë§íˆ¬Â·ì„±ê²©Â·ê¸ˆê¸°ì‚¬í•­"| PREPARE
    PREPARE -->|"ì—ì…‹ ì œì‘ ìš”ì²­"| CRAFT
    CRAFT -->|"ì œì‘ëœ ì—ì…‹"| ASSET_STORE
    PREPARE -->|"BroadcastStrategy"| LIVE_BRAIN

    CONTENT_POOL -.->|"tool: fetch_content()"| LIVE_BRAIN
    FAN_MEMORY -.->|"tool: lookup_fan()"| LIVE_BRAIN
    ASSET_STORE -.->|"tool: fetch_asset()"| LIVE_BRAIN
    PERSONA -.->|"tool: check_persona()"| LIVE_BRAIN

    LIVE_BRAIN -->|"session_log"| REVIEW

    REVIEW -->|"FanSignals<br/>íŒ¬ í™œë™ ê¸°ë¡Â·ì£¼ëª© ì´ë²¤íŠ¸"| BOND_EVAL
    REVIEW -->|"ContentSignals<br/>ì†Œì¬ ì„±ê³¼Â·ì½˜í…ì¸  ê°­"| PERSONA_EVAL
    REVIEW -->|"ContentSignals<br/>íŠ¸ë Œë“œ ì ì¤‘Â·ì²­ì¤‘ ê´€ì‹¬ì‚¬"| SCOUT_EVAL
    REVIEW -->|"StrategyFeedback<br/>â†’ ë‹¤ìŒ prepare"| PREPARE

    PERSONA_EVAL -->|"ì†Œì¬ ìŠ¤ì½”ì–´ ì—…ë°ì´íŠ¸<br/>ìºë¦­í„° ê°€ì´ë“œ ë³´ì •"| CONTENT_POOL
    PERSONA_EVAL -->|"í˜ë¥´ì†Œë‚˜ ë¯¸ì„¸ ì¡°ì •"| PERSONA
    BOND_EVAL -->|"íŒ¬ ë°ì´í„° ì—…ë°ì´íŠ¸<br/>DM íì‰"| FAN_MEMORY
    SCOUT_EVAL -->|"íƒìƒ‰ ìš°ì„ ìˆœìœ„ ë³´ì •"| SCOUT

    style ALWAYS_ON fill:#e8f5e9,stroke:#81c784,color:#2d3d2f
    style PRE_BROADCAST fill:#e3f2fd,stroke:#64b5f6,color:#2d3d4f
    style LIVE fill:#fce4ec,stroke:#e57373,color:#3d2d2f,stroke-width:3px
    style POST_BROADCAST fill:#ede7f6,stroke:#b39ddb,color:#3d2d4f

    style SCOUT fill:#c8e6c9,stroke:#66bb6a,color:#2d3d2f
    style BOND fill:#c8e6c9,stroke:#66bb6a,color:#2d3d2f
    style PERSONA fill:#bbdefb,stroke:#42a5f5,color:#2d3d4f
    style CRAFT fill:#bbdefb,stroke:#42a5f5,color:#2d3d4f
    style PREPARE fill:#bbdefb,stroke:#42a5f5,color:#2d3d4f
    style LIVE_BRAIN fill:#ef9a9a,stroke:#e57373,color:#3d1f1f,stroke-width:2px
    style REVIEW fill:#ce93d8,stroke:#ab47bc,color:#fff
    style PERSONA_EVAL fill:#e1bee7,stroke:#ba68c8,color:#3d2d4f
    style BOND_EVAL fill:#e1bee7,stroke:#ba68c8,color:#3d2d4f
    style SCOUT_EVAL fill:#e1bee7,stroke:#ba68c8,color:#3d2d4f

    style CONTENT_POOL fill:#bbdefb,stroke:#64b5f6,color:#2d3d4f
    style FAN_MEMORY fill:#bbdefb,stroke:#64b5f6,color:#2d3d4f
    style ASSET_STORE fill:#bbdefb,stroke:#64b5f6,color:#2d3d4f
                    </pre>
                </div>
            </div>
            <div class="fullscreen-hint">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>
                í´ë¦­í•˜ì—¬ ì „ì²´í™”ë©´
            </div>
        </div>
    </div>

    <!-- í•™ìŠµ ë£¨í”„ -->
    <div class="section">
        <h2>í•™ìŠµ ë£¨í”„</h2>
        <p class="subtitle">í´ë¦­í•˜ë©´ ì „ì²´í™”ë©´ìœ¼ë¡œ í™•ëŒ€ë©ë‹ˆë‹¤</p>
        <div class="mermaid-wrapper" onclick="openFullscreen('loop', 'í•™ìŠµ ë£¨í”„')" data-diagram="loop">
            <div class="zoom-controls" onclick="event.stopPropagation()">
                <button onclick="zoomDiagram('loop', -0.1)">âˆ’</button>
                <div class="zoom-label" id="loop-zoom-label">100%</div>
                <button onclick="zoomDiagram('loop', 0.1)">+</button>
                <button onclick="zoomDiagram('loop', 0, true)">â†º</button>
            </div>
            <div class="mermaid-viewport" id="loop-viewport" onwheel="wheelZoom(event, 'loop')" onclick="event.stopPropagation()">
                <div class="mermaid-inner" id="loop-inner">
                    <pre class="mermaid" id="mermaid-loop">
graph LR
    S1["ğŸ™ï¸ ë°©ì†¡ N<br/>on_event"] --> R1["ğŸ“Š Review<br/>íŒ©íŠ¸ ì •ë¦¬"]
    R1 --> E1["ğŸ”ğŸ“–ğŸ¤<br/>ê° ì—ì´ì „íŠ¸<br/>ìê¸° ê´€ì  í‰ê°€"]
    E1 --> U1["ğŸ’¾ DB ì—…ë°ì´íŠ¸<br/>Content Pool<br/>Fan Memory<br/>íƒìƒ‰ ì „ëµ"]
    U1 --> P2["ğŸ“‹ Prepare<br/>ë³´ì •ëœ ì „ëµ"]
    P2 --> S2["ğŸ™ï¸ ë°©ì†¡ N+1<br/>on_event"]

    style S1 fill:#ef9a9a,color:#3d1f1f,stroke:#e57373
    style R1 fill:#ce93d8,color:#fff,stroke:#ab47bc
    style E1 fill:#e1bee7,stroke:#ba68c8,color:#3d2d4f
    style U1 fill:#bbdefb,color:#2d3d4f,stroke:#64b5f6
    style P2 fill:#bbdefb,color:#2d3d4f,stroke:#64b5f6
    style S2 fill:#ef9a9a,color:#3d1f1f,stroke:#e57373
                    </pre>
                </div>
            </div>
            <div class="fullscreen-hint">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>
                í´ë¦­í•˜ì—¬ ì „ì²´í™”ë©´
            </div>
        </div>
    </div>

    <!-- ë°ì´í„° íë¦„ í…Œì´ë¸” -->
    <div class="section">
        <h2>ë°ì´í„° íë¦„ ìƒì„¸</h2>

        <span class="phase-label phase-always">ğŸ”„ ìƒì‹œ ë™ì‘</span>
        <table class="flow-table">
            <thead><tr><th>From</th><th>To</th><th>ë°ì´í„°</th><th>ì„¤ëª…</th></tr></thead>
            <tbody>
                <tr><td>Scout</td><td>Persona</td><td><code>raw_trends</code></td><td>íŠ¸ë Œë“œ ì›ì¬ë£Œ (ë°ˆ, ë‰´ìŠ¤, í† í”½)</td></tr>
                <tr><td>Persona</td><td>Content Pool</td><td><code>adapted_content</code></td><td>ìºë¦­í„°ì— ë§ê²Œ ê°€ê³µëœ ì†Œì¬</td></tr>
                <tr><td>Bond</td><td>Fan Memory</td><td>íŒ¬ ê´€ê³„ ê´€ë¦¬ ì•¡ì…˜</td><td>ì´íƒˆ ìœ„í—˜ DM ì¶”ì²œ, ì„¸ê·¸ë¨¼íŠ¸ ì¬ë¶„ë¥˜</td></tr>
            </tbody>
        </table>

        <br/>
        <span class="phase-label phase-pre">ğŸ“‹ ë°©ì†¡ ì „ (Prepare)</span>
        <table class="flow-table">
            <thead><tr><th>From</th><th>To</th><th>ë°ì´í„°</th><th>ì„¤ëª…</th></tr></thead>
            <tbody>
                <tr><td>Content Pool</td><td>Live [prepare]</td><td>ìš°ì„ ìˆœìœ„ ì†Œì¬ ëª©ë¡</td><td>ì´ë²ˆ ë°©ì†¡ì— ì“¸ ì†Œì¬ í</td></tr>
                <tr><td>Fan Memory</td><td>Live [prepare]</td><td>VIP íŒ¬ ë¦¬ìŠ¤íŠ¸ + ì•Œë¦¼</td><td>ì£¼ëª©í•  íŒ¬, ìµœê·¼ í–‰ë™ ìš”ì•½</td></tr>
                <tr><td>Persona</td><td>Live [prepare]</td><td>ìºë¦­í„° ì„¤ì • ìŠ¤ëƒ…ìƒ·</td><td>ë§íˆ¬, ì„±ê²©, ê¸ˆê¸°ì‚¬í•­</td></tr>
                <tr><td>Live [prepare]</td><td>Craft</td><td>ì—ì…‹ ì œì‘ ìš”ì²­</td><td>ìŠ¤í† ë¦¬ë³´ë“œ, í•„ìš” ì´ë¯¸ì§€ ëª©ë¡</td></tr>
                <tr><td>Craft</td><td>Asset Store</td><td>ì œì‘ëœ ì—ì…‹</td><td>ì˜ìƒ í´ë¦½, ì´ë¯¸ì§€, í”„ë¦¬ì…‹</td></tr>
                <tr><td>Live [prepare]</td><td>Live [on_event]</td><td><code>BroadcastStrategy</code></td><td>ì „ëµ, ì†Œì¬í, íŒ¬ì›Œì¹˜ë¦¬ìŠ¤íŠ¸, KPI</td></tr>
            </tbody>
        </table>

        <br/>
        <span class="phase-label phase-live">âš¡ ë°©ì†¡ ì¤‘ (On-Air)</span>
        <table class="flow-table">
            <thead><tr><th>From</th><th>To</th><th>ë°ì´í„°</th><th>í˜¸ì¶œ ë°©ì‹</th></tr></thead>
            <tbody>
                <tr><td>Content Pool</td><td>Live [on_event]</td><td>ì†Œì¬ ê²€ìƒ‰ ê²°ê³¼</td><td><code>tool: fetch_content()</code></td></tr>
                <tr><td>Fan Memory</td><td>Live [on_event]</td><td>íŒ¬ í”„ë¡œí•„Â·íˆìŠ¤í† ë¦¬</td><td><code>tool: lookup_fan()</code></td></tr>
                <tr><td>Asset Store</td><td>Live [on_event]</td><td>ì¤€ë¹„ëœ ì—ì…‹</td><td><code>tool: fetch_asset()</code></td></tr>
                <tr><td>Persona</td><td>Live [on_event]</td><td>í˜ë¥´ì†Œë‚˜ ì²´í¬</td><td><code>tool: check_persona()</code></td></tr>
            </tbody>
        </table>

        <br/>
        <span class="phase-label phase-post">ğŸ“Š ë°©ì†¡ í›„ (Review & Evaluate)</span>
        <table class="flow-table">
            <thead><tr><th>From</th><th>To</th><th>ë°ì´í„°</th><th>ì„¤ëª…</th></tr></thead>
            <tbody>
                <tr><td>Live [review]</td><td>Bond [evaluate]</td><td><code>FanSignals</code></td><td>íŒ¬ í™œë™ ê¸°ë¡, ì£¼ëª© ì´ë²¤íŠ¸, ì„¸ê·¸ë¨¼íŠ¸ ê´€ì°°</td></tr>
                <tr><td>Live [review]</td><td>Persona [evaluate]</td><td><code>ContentSignals</code></td><td>ì†Œì¬ ì„±ê³¼, ì½˜í…ì¸  ê°­, ìºë¦­í„° ë°˜ì‘ ë°ì´í„°</td></tr>
                <tr><td>Live [review]</td><td>Scout [evaluate]</td><td><code>ContentSignals</code></td><td>íŠ¸ë Œë“œ ì ì¤‘ë¥ , ì²­ì¤‘ ê´€ì‹¬ì‚¬ ì‹ í˜¸</td></tr>
                <tr><td>Live [review]</td><td>ë‹¤ìŒ prepare</td><td><code>StrategyFeedback</code></td><td>íš¨ê³¼ íŒ¨í„´, íŒŒë¼ë¯¸í„° ë³´ì • ê¶Œê³ </td></tr>
                <tr><td>Persona [evaluate]</td><td>Content Pool</td><td>ìŠ¤ì½”ì–´ ì—…ë°ì´íŠ¸</td><td>ì†Œì¬ë³„ ìºë¦­í„° ì í•©ë„ ì¬í‰ê°€</td></tr>
                <tr><td>Persona [evaluate]</td><td>Persona</td><td>ê°€ì´ë“œë¼ì¸ ë³´ì •</td><td>í˜ë¥´ì†Œë‚˜ ë¯¸ì„¸ ì¡°ì •</td></tr>
                <tr><td>Bond [evaluate]</td><td>Fan Memory</td><td>íŒ¬ ë°ì´í„° ì—…ë°ì´íŠ¸</td><td>ì„¸ê·¸ë¨¼íŠ¸ë³„ ë°˜ì‘ í•´ì„, DM íì‰</td></tr>
                <tr><td>Scout [evaluate]</td><td>Scout</td><td>íƒìƒ‰ ì „ëµ ë³´ì •</td><td>ìš°ì„ ìˆœìœ„ ì¬ì¡°ì •, í¬ë¡¤ë§ ë°©í–¥ ë³€ê²½</td></tr>
            </tbody>
        </table>
    </div>

</div>

<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: 'base',
        themeVariables: {
            primaryColor: '#e3f2fd',
            primaryTextColor: '#2d3d4f',
            primaryBorderColor: '#64b5f6',
            lineColor: '#90a4ae',
            secondaryColor: '#f3e5f5',
            tertiaryColor: '#e8f5e9',
            background: '#ffffff',
            mainBkg: '#e3f2fd',
            nodeBorder: '#64b5f6',
            clusterBkg: '#fafafa',
            clusterBorder: '#e0e0e0',
            titleColor: '#2d3d4f',
            edgeLabelBackground: '#ffffff',
            fontSize: '13px'
        },
        flowchart: {
            useMaxWidth: false,
            htmlLabels: true,
            curve: 'basis',
            padding: 20,
            nodeSpacing: 50,
            rankSpacing: 60
        }
    });

    /* ===== ì¸ë¼ì¸ ì¤Œ (ê¸°ì¡´) ===== */
    const zoomState = { main: { scale: 1 }, loop: { scale: 1 } };

    function zoomDiagram(id, delta, reset) {
        if (reset) zoomState[id].scale = 1;
        else zoomState[id].scale = Math.max(0.3, Math.min(3, zoomState[id].scale + delta));
        document.getElementById(id + '-inner').style.transform = `scale(${zoomState[id].scale})`;
        document.getElementById(id + '-zoom-label').textContent = Math.round(zoomState[id].scale * 100) + '%';
    }

    function wheelZoom(event, id) {
        event.preventDefault();
        zoomDiagram(id, event.deltaY > 0 ? -0.05 : 0.05);
    }

    /* ===== ì „ì²´í™”ë©´ ===== */
    let fsScale = 1;
    let currentDiagramId = null;

    function openFullscreen(diagramId, title) {
        currentDiagramId = diagramId;
        const overlay = document.getElementById('fullscreenOverlay');
        const fsInner = document.getElementById('fsInner');
        const fsTitle = document.getElementById('fsTitle');

        // ë Œë”ë§ëœ SVGë¥¼ ë³µì‚¬
        const source = document.getElementById('mermaid-' + diagramId);
        const svg = source.tagName === 'svg' ? source : source.querySelector('svg') || source.nextElementSibling;
        
        if (svg) {
            fsInner.innerHTML = svg.outerHTML;
        } else {
            // fallback: inner ì „ì²´ ë³µì‚¬
            const inner = document.getElementById(diagramId + '-inner');
            fsInner.innerHTML = inner.innerHTML;
        }

        fsTitle.textContent = title;
        overlay.classList.add('active');
        document.body.style.overflow = 'hidden';

        // fit to screen
        fitToScreen();
    }

    function fitToScreen() {
        const viewport = document.getElementById('fsViewport');
        const inner = document.getElementById('fsInner');
        const svg = inner.querySelector('svg');

        if (svg) {
            const vw = viewport.clientWidth - 80;
            const vh = viewport.clientHeight - 80;
            const sw = svg.getBoundingClientRect().width / (fsScale || 1);
            const sh = svg.getBoundingClientRect().height / (fsScale || 1);
            fsScale = Math.min(vw / sw, vh / sh, 2);
            inner.style.transform = `scale(${fsScale})`;
            document.getElementById('fsZoomLabel').textContent = Math.round(fsScale * 100) + '%';
        }
    }

    function exitFullscreen() {
        const overlay = document.getElementById('fullscreenOverlay');
        overlay.classList.remove('active');
        document.body.style.overflow = '';
        fsScale = 1;
        document.getElementById('fsInner').innerHTML = '';
        currentDiagramId = null;
    }

    function fsZoom(delta, reset) {
        if (reset) {
            fitToScreen();
            return;
        }
        fsScale = Math.max(0.2, Math.min(5, fsScale + delta));
        document.getElementById('fsInner').style.transform = `scale(${fsScale})`;
        document.getElementById('fsZoomLabel').textContent = Math.round(fsScale * 100) + '%';
    }

    // ESC í‚¤ë¡œ ë‚˜ê°€ê¸°
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') exitFullscreen();
    });

    // ì „ì²´í™”ë©´ ë·°í¬íŠ¸ ë§ˆìš°ìŠ¤ íœ  ì¤Œ
    document.getElementById('fsViewport').addEventListener('wheel', (e) => {
        e.preventDefault();
        fsZoom(e.deltaY > 0 ? -0.08 : 0.08);
    }, { passive: false });

    // ì „ì²´í™”ë©´ ë“œë˜ê·¸ ì´ë™
    (function() {
        const vp = document.getElementById('fsViewport');
        let dragging = false, sx, sy, sl, st;
        vp.addEventListener('mousedown', e => { dragging = true; sx = e.pageX; sy = e.pageY; sl = vp.scrollLeft; st = vp.scrollTop; });
        vp.addEventListener('mouseup', () => dragging = false);
        vp.addEventListener('mouseleave', () => dragging = false);
        vp.addEventListener('mousemove', e => {
            if (!dragging) return;
            e.preventDefault();
            vp.scrollLeft = sl - (e.pageX - sx);
            vp.scrollTop = st - (e.pageY - sy);
        });
    })();

    // ì¸ë¼ì¸ ë“œë˜ê·¸ ì´ë™ (ê¸°ì¡´)
    document.querySelectorAll('.mermaid-viewport:not(#fsViewport)').forEach(viewport => {
        let isDragging = false, startX, startY, scrollLeft, scrollTop;
        viewport.addEventListener('mousedown', (e) => {
            isDragging = true; startX = e.pageX - viewport.offsetLeft; startY = e.pageY - viewport.offsetTop;
            scrollLeft = viewport.scrollLeft; scrollTop = viewport.scrollTop;
        });
        viewport.addEventListener('mouseleave', () => isDragging = false);
        viewport.addEventListener('mouseup', () => isDragging = false);
        viewport.addEventListener('mousemove', (e) => {
            if (!isDragging) return; e.preventDefault();
            viewport.scrollLeft = scrollLeft - ((e.pageX - viewport.offsetLeft) - startX);
            viewport.scrollTop = scrollTop - ((e.pageY - viewport.offsetTop) - startY);
        });
    });
</script>

</body>
</html>
